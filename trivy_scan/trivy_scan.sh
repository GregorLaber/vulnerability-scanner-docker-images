#!/bin/bash

images=(ubuntu:20.04 centos:8 postgres:14.1 mongo:5.0.5 httpd:2.4 nginx:1.21 wordpress:5.8 openjdk:17-jdk grafana/grafana:8.3.3 bitnami/redis:6.2.6 sagikazarmark/dvwa:latest dpage/pgadmin4:6.3)

echo "Scan items:"
for item in "${images[@]}"; do
    printf " %s\n" "$item"
done

for item in "${images[@]}"; do
    name=$(echo "$item" | tr / _)
    docker run --rm -v /var/run/docker.sock:/var/run/docker.sock -v "${PWD}"/cache:/root/.cache/ aquasec/trivy image "$item" >"$name"_scan.txt
done
